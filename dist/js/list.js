"use strict";$(function(){var h,f=getRequest(),m=f.class,s=f.sort,a=1;function n(){$.ajax({type:"get",url:"../api/car_goods.php",data:{class:m,page:a,qty:5,sort:s},success:function(s){var a=JSON.parse(s);console.log(a);var n=[],t=[];a.listAll.map(function(s){n.push(s.shop),t.push(s.type)});var l=Dupli(n),i=Dupli(t);console.log(i),h=a.pages;var e='您已选择: \n                            <a href="" class="list_class">'+a.class+'\n                                <div class="class_hide"><span>女装</span><span>男装</span></div>\n                            </a>\n                            > "'+a.class+'"\n                            <span class="list_num">共 <small>'+a.num+"</small> 件相关商品</span>";$(".list_searched").html(e);var c='<dl class="list_pin">\n                                <dt>品牌:</dt>\n                                <dd>\n                                   '+_(l)+'\n                                </dd>\n                                <div class="more">更多</div>\n                            </dl>\n                            <dl class="list_nan">\n                                <dt>'+a.class+":</dt>\n                                <dd>\n                                    "+_(i)+'\n                                </dd>\n                                <div class="more">更多</div>\n                            </dl>\n                            <dl class="list_model">\n                                <dt>版型:</dt>\n                                <dd>\n                                    <a href="##">常规型</a>\n                                    <a href="##">合身型</a>\n                                    <a href="##">修身型</a>\n                                    <a href="##">标准型</a>\n                                    <a href="##">宽松型</a>\n                                    <a href="##">常规款</a>\n                                    <a href="##">时尚型</a>\n                                    <a href="##">直筒型</a>\n                                </dd>\n                                <div class="more">更多</div>\n                            </dl>\n                            <dl class="list_tex">\n                                <dt>花型:</dt>\n                                <dd>\n                                    <a href="##">净色</a>\n                                    <a href="##">条纹</a>\n                                    <a href="##">图案</a>\n                                    <a href="##">格子</a>\n                                    <a href="##">其它</a>\n                                    <a href="##">印花</a>\n                                    <a href="##">提花</a>\n                                    <a href="##">间条</a>\n                                    <a href="##">花案</a>\n                                    <a href="##">波点</a>\n                                    <a href="##">花草</a>\n                                    <a href="##">动物</a>\n                                    <a href="##">卡通</a>\n                                </dd>\n                                <div class="more">更多</div>\n                            </dl>';$(".list_search").html(c);var p='<div class="sort_left">\n                                <span>综合<img src="../image/list/c_down.png" alt=""></span>\n                                <span>销量<img src="../image/list/c_down.png" alt=""></span>\n                                <span class="num">好评<img src="../image/list/c_down.png" alt=""></span>\n                                <span class="time">最新<img src="../image/list/c_down.png" alt=""></span>\n                                <span class="pprice">价格<img src="../image/list/price_0.png" alt=""></span>\n                                <input type="text" placeholder="￥" class="price_one">\n                                <span>至</span>\n                                <input type="text" placeholder="￥" class="price_tow">\n                                <span><input type="checkbox">促销商品</span>\n                                <span><input type="checkbox">梦芭莎旗舰店</span>\n                            </div>\n                            <div class="sort_right">\n                                <span>共 '+a.num+" 个商品</span>　|　\n                                <strong>"+a.page+"/"+a.pages+'</strong>\n                                <a href="##" class="sort_prev">&lt;</a>\n                                <a href="##" class="sort_next">&gt;</a>\n                            </div>';$(".list_sort").html(p);var r=a.list.map(function(s){var a,n=s.img.split(","),t=s.codenum.split(","),l=s.color.split(",");return'<li data-id="'+s.id+'">\n                                <div class="box_img">\n                                    <img src="../image/list/'+n[0]+'" alt="">\n                                    <div class="size">尺寸：'+function(s){for(var a="",n=0;n<s.length;n++)a+="<span>"+s[n]+"</span>";return a}(t)+'</div>\n                                </div>\n                                <div class="sma_img">\n                                    '+function(s,a){for(var n="",t=0;t<s.length;t++)n+='<span><img src="../image/list/'+a[6*t]+'" alt=""></span>';return n}(l,n)+'\n                                </div>\n                                <div class="price">\n                                    <span class="pprice">'+s.pprice+"</span>\n                                    "+((a=s.oprice)?'<span class="oprice">'+a+"</span>":"")+'\n                                </div>\n                                <div class="title whole_dan">'+s.title+'</div>\n                                <div class="shop">'+s.shop+'</div>\n                                <div class="comment">评论<span>'+s.num+"条</span></div>\n                            </li>"});$(".list_goods ul").html(r);var o="<strong>"+a.page+"/"+a.pages+"</strong>";$(".list_page").html(o);for(var d=a.pages;1<=d;d--)d==a.page?$('<span class="active page">'+d+"</span>").prependTo(".list_page"):$('<span class="page">'+d+"</span>").prependTo(".list_page");for(var g in $('<span class="page_prev">上一页</span>').prependTo(".list_page"),$('<span class="page_next">下一页</span>').appendTo(".list_page"),$(".list_goods ul li").on("click",function(){window.location.href="details.html?id="+this.dataset.id}),$(".list_pin").on("click","a",function(){$(".list_pin a").css({background:"none",color:"#222"}),$(this).css({background:"#222",color:"#fff"}),$.ajax({type:"get",url:"../api/car_goods.php",data:{shop:$(this).html(),class:m},success:function(s){var a=JSON.parse(s);console.log(a)}})}),f)$(".sort_left span").hasClass(""+f[g])&&$(".sort_left ."+f[g]).addClass("active");1<a.pages&&$(".list_page").css({display:"block"}),listArr()}})}function _(s){for(var a="",n=0;n<s.length;n++)a+='<a href="javascript:;">'+s[n]+"</a>";return a}n(),$(".list_sort").on("click",".pprice",function(){window.location.href="list.html?class="+m+"&sort=pprice",scroll()}),$(".list_sort").on("click",".time",function(){window.location.href="list.html?class="+m+"&sort=time"}),$(".list_sort").on("click",".num",function(){window.location.href="list.html?class="+m+"&sort=num"}),$(".list_sort").on("click",".sort_next",function(){h<=a?(alert("已经是最后一页了"),a=h):(a++,n())}),$(".list_page").on("click",".page_next",function(){h<=a?(alert("已经是最后一页了"),a=h):(a++,n())}),$(".list_sort").on("click",".sort_prev",function(){--a<1?(alert("已经是第一页"),a=1):n()}),$(".list_page").on("click",".page_prev",function(){--a<1?(alert("已经是第一页"),a=1):n()}),$(".list_page").on("click",".page",function(){1*$(this).html!=a&&(a=1*$(this).html(),n())}),insClick(),Niscookie()});